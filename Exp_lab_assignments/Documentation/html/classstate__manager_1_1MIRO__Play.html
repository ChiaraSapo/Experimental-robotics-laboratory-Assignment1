<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Exp_Lab_Assignments: state_manager.MIRO_Play Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Exp_Lab_Assignments
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>state_manager</b></li><li class="navelem"><a class="el" href="classstate__manager_1_1MIRO__Play.html">MIRO_Play</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classstate__manager_1_1MIRO__Play-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">state_manager.MIRO_Play Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Play state of the smach machine.  
 <a href="classstate__manager_1_1MIRO__Play.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for state_manager.MIRO_Play:</div>
<div class="dyncontent">
<div class="center"><img src="classstate__manager_1_1MIRO__Play__inherit__graph.png" border="0" usemap="#state__manager_8MIRO__Play_inherit__map" alt="Inheritance graph"/></div>
<map name="state__manager_8MIRO__Play_inherit__map" id="state__manager_8MIRO__Play_inherit__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for state_manager.MIRO_Play:</div>
<div class="dyncontent">
<div class="center"><img src="classstate__manager_1_1MIRO__Play__coll__graph.png" border="0" usemap="#state__manager_8MIRO__Play_coll__map" alt="Collaboration graph"/></div>
<map name="state__manager_8MIRO__Play_coll__map" id="state__manager_8MIRO__Play_coll__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a863ae1958460cf6bf33faaba597fc5a2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstate__manager_1_1MIRO__Play.html#a863ae1958460cf6bf33faaba597fc5a2">__init__</a> (self)</td></tr>
<tr class="memdesc:a863ae1958460cf6bf33faaba597fc5a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init function for smach machine play state.  <a href="#a863ae1958460cf6bf33faaba597fc5a2">More...</a><br /></td></tr>
<tr class="separator:a863ae1958460cf6bf33faaba597fc5a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a781db4be4fcbb313c46097a8fdf06275"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classstate__manager_1_1MIRO__Play.html#a781db4be4fcbb313c46097a8fdf06275">execute</a> (self, userdata)</td></tr>
<tr class="memdesc:a781db4be4fcbb313c46097a8fdf06275"><td class="mdescLeft">&#160;</td><td class="mdescRight">Smach machine state play actions: Looks at user, saves his coordinates as next position, publishes them (goes toward the human).  <a href="#a781db4be4fcbb313c46097a8fdf06275">More...</a><br /></td></tr>
<tr class="separator:a781db4be4fcbb313c46097a8fdf06275"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Play state of the smach machine. </p>

<p>Definition at line <a class="el" href="state__manager_8py_source.html#l00154">154</a> of file <a class="el" href="state__manager_8py_source.html">state_manager.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a863ae1958460cf6bf33faaba597fc5a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def state_manager.MIRO_Play.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init function for smach machine play state. </p>

<p>Definition at line <a class="el" href="state__manager_8py_source.html#l00157">157</a> of file <a class="el" href="state__manager_8py_source.html">state_manager.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classstate__manager_1_1MIRO__Play.html#a863ae1958460cf6bf33faaba597fc5a2">  157</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classstate__manager_1_1MIRO__Play.html#a863ae1958460cf6bf33faaba597fc5a2">__init__</a>(self):</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        smach.State.__init__(self,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                             outcomes=[<span class="stringliteral">&#39;normal_command&#39;</span>])</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="ttc" id="classstate__manager_1_1MIRO__Play_html_a863ae1958460cf6bf33faaba597fc5a2"><div class="ttname"><a href="classstate__manager_1_1MIRO__Play.html#a863ae1958460cf6bf33faaba597fc5a2">state_manager.MIRO_Play.__init__</a></div><div class="ttdeci">def __init__(self)</div><div class="ttdoc">Init function for smach machine play state. </div><div class="ttdef"><b>Definition:</b> <a href="state__manager_8py_source.html#l00157">state_manager.py:157</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a781db4be4fcbb313c46097a8fdf06275"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def state_manager.MIRO_Play.execute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>userdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Smach machine state play actions: Looks at user, saves his coordinates as next position, publishes them (goes toward the human). </p>
<p>It then listens to the user. If user says "go to posx posy", publishes the coordinates (goes to the point). If user says "Hey buddy" or "Play" it waits. If user says nothing, it looks for the user gesture to go somewhere, and publishes the coordinate he receives (goes to the point). This repeates for a while (n loops) then the robot enters normal state again. </p><dl class="section return"><dt>Returns</dt><dd>c: command to switch between states. </dd></dl>

<p>Definition at line <a class="el" href="state__manager_8py_source.html#l00169">169</a> of file <a class="el" href="state__manager_8py_source.html">state_manager.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="classstate__manager_1_1MIRO__Play.html#a781db4be4fcbb313c46097a8fdf06275">  169</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classstate__manager_1_1MIRO__Play.html#a781db4be4fcbb313c46097a8fdf06275">execute</a>(self, userdata):</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment"># Set state parameter</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        rospy.set_param(<span class="stringliteral">&#39;state&#39;</span>, <span class="stringliteral">&#39;PLAY STATE&#39;</span>)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, LOOPS):</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="comment"># Check where user is (assumption:he is there, since he called MIRO)</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            user_camera = user_does()</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="comment"># Save user position</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            user_position = <span class="stringliteral">&quot;go to %d %d&quot;</span> % (</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                user_camera[0], user_camera[1])</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment"># Wait to be ready</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">while</span> rospy.get_param(<span class="stringliteral">&#39;arrived&#39;</span>) == 0:</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                time.sleep(1)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            rospy.set_param(<span class="stringliteral">&#39;arrived&#39;</span>, 0)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment"># Go to user</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            pub.publish(user_position)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            time.sleep(3)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment"># Listen to user</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            user_command = user_says(1)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment"># If user says to go somewhere...</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">if</span> <span class="stringliteral">&#39;go&#39;</span> <span class="keywordflow">in</span> user_command <span class="keywordflow">and</span> <span class="stringliteral">&#39;to&#39;</span> <span class="keywordflow">in</span> user_command:</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                check_int = [int(s)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                             <span class="keywordflow">for</span> s <span class="keywordflow">in</span> user_command.split() <span class="keywordflow">if</span> s.isdigit()]</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="comment"># ... and he actually gives you two coordinates...</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <span class="keywordflow">if</span> len(check_int) != 2:</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    rospy.logerr(<span class="stringliteral">&#39;Wrong command&#39;</span>)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    <span class="keywordflow">break</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="comment"># Wait to be ready</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">while</span> rospy.get_param(<span class="stringliteral">&#39;arrived&#39;</span>) == 0:</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    time.sleep(1)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                rospy.set_param(<span class="stringliteral">&#39;arrived&#39;</span>, 0)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="comment"># ...Go to position</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                pub.publish(user_command)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                time.sleep(3)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="comment"># If user says he wants to play: wait</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="keywordflow">elif</span> user_command == <span class="stringliteral">&#39;hey buddy&#39;</span> <span class="keywordflow">or</span> user_command == <span class="stringliteral">&#39;play&#39;</span>:</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                time.sleep(2)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment"># If user sayes nothing</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="comment"># Look at user gesture</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                user_gesture = user_does()</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                user_command = <span class="stringliteral">&quot;go to %d %d&quot;</span> % (</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    user_camera.gesture_posx, user_camera.gesture_posy)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="keywordflow">while</span> rospy.get_param(<span class="stringliteral">&#39;arrived&#39;</span>) == 0:</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    time.sleep(1)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                rospy.set_param(<span class="stringliteral">&#39;arrived&#39;</span>, 0)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="comment"># Go to position</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                pub.publish(user_command)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                time.sleep(3)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        c = <span class="stringliteral">&#39;normal_command&#39;</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">return</span> c</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="ttc" id="classstate__manager_1_1MIRO__Play_html_a781db4be4fcbb313c46097a8fdf06275"><div class="ttname"><a href="classstate__manager_1_1MIRO__Play.html#a781db4be4fcbb313c46097a8fdf06275">state_manager.MIRO_Play.execute</a></div><div class="ttdeci">def execute(self, userdata)</div><div class="ttdoc">Smach machine state play actions: Looks at user, saves his coordinates as next position, publishes them (goes toward the human). </div><div class="ttdef"><b>Definition:</b> <a href="state__manager_8py_source.html#l00169">state_manager.py:169</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/<a class="el" href="state__manager_8py_source.html">state_manager.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
